<ion-header>
    <ion-toolbar *ngIf="!edit_mode" [color]="current_color">
        <ion-buttons start>
            <button class="search_icon" ion-button icon-only>
                <ion-icon name="search"></ion-icon>
            </button>
        </ion-buttons>
        <ion-title>
            <div class="dots_box">
                <span class="un_active_dot"></span>
                <span class="dot"></span>
            </div>
        </ion-title>
        <ion-buttons end>
            <button (tap)="go_to_editor()" ion-button icon-only>
                <ion-icon name="add"></ion-icon>
            </button>
        </ion-buttons>
    </ion-toolbar>
    <ion-toolbar *ngIf="edit_mode" [color]="current_color">
        <ion-buttons start>
            <button (tap)="close_bulk_actions()" ion-button icon-only>
                <!--<ion-icon name="close"></ion-icon>-->
                <span class="close_icon_overflowing"></span>
            </button>
        </ion-buttons>
        <ion-buttons end>
            <button ion-button icon-only>
                <ion-icon name="share"></ion-icon>
            </button>
            <button ion-button icon-only>
                <ion-icon name="lock"></ion-icon>
            </button>
            <button ion-button icon-only>
                <ion-icon name="trash"></ion-icon>
            </button>
        </ion-buttons>
    </ion-toolbar>
</ion-header>
<ion-content padding>
    <div id="wrapper">
        <ion-list *ngIf="!edit_mode && anototes.length > 0" class="product-list">
            <ion-item (press)="bulkAction(anotote)" *ngFor="let anotote of anototes" [ngClass]="anotote.type==2?'active':''">
                <div (tap)="openAnototeDetail(anotote)">
                    <div *ngIf="!anotote.active && current_color == 'me' || current_color == 'follow'" class="img-holder">
                        <img [src]="(anotote.userAnnotote != null && anotote.userAnnotote.annotote.photo != null)?anotote.userAnnotote.annotote.photo:'assets/img/img2.png'">
                    </div>
                    <div *ngIf="!anotote.active && current_color == 'top'" class="img-holder">
                        <img [src]="(anotote.annotote.photo != null)?anotote.annotote.photo:'assets/img/img2.png'">
                    </div>
                    <span class="options" *ngIf="anotote.active"></span>
                    <div class="txt" *ngIf="anotote.type ==1">
                        <strong [innerText]="anotote.userAnnotote.annotote.title"></strong>
                        <p [innerText]="anotote.userAnnotote.annotote.source"></p>
                        <div class="time">
                            <em>
                            <button type="button">
                                <ion-icon name="text"></ion-icon>
                            </button>
                            <span [innerText]="anotote.createdAt"></span>
                        </em>
                        </div>
                    </div>
                    <div class="txt" *ngIf="anotote.type ==2">
                        <strong [innerText]="anotote.chatGroup.name"></strong>
                        <p [innerText]="anotote.chatGroup.name"></p>
                        <div class="time">
                            <em>
                          <button type="button">
                            <ion-icon name="chatbubbles"></ion-icon>
                          </button>
                          <span [innerText]="anotote.createdAt"></span>
                        </em>
                        </div>
                    </div>
                </div>
                <!-- anatote detail -->
                <div *ngIf="anotote.active && anotote.type!=2" [@enterAnimation]>
                    <header class="header">
                        <div class="underlist-text">
                            <div class="btns-area">
                                <button (click)="showMeHighlights()" ion-button class="active me-tab">Me</button>
                                <button (click)="open_follows_popup($event)" ion-button class="active bardaro-tab">{{current_active_anotote.firstFollowerName}} ({{current_active_anotote.followers.length}})</button>
                                <button ion-button class="active top-tab">Top</button>
                            </div>
                        </div>
                    </header>
                    <div class="quotes layout message-underlist">
                        <ion-list no-lines class="details-list layout">
                            <ion-item class="underlist-items" *ngFor="let highlight of anotote.highlights">
                                <div class="txt">
                                    <p *ngIf="highlight.comment == null || highlight.comment == ''">{{highlight.highlightText}}</p>
                                    <p *ngIf="highlight.comment != null && highlight.comment != ''">{{highlight.comment}}</p>
                                </div>
                                <span class="status" *ngIf="highlight.comment == null || highlight.comment == ''">"</span>
                                <span class="status" *ngIf="highlight.comment != null || highlight.comment != ''">*</span>
                            </ion-item>
                        </ion-list>
                    </div>
                </div>
                <!-- Anotote Message Detail Section -->
                <div (tap)="go_to_chat_thread(anotote.chatGroup.groupUsers)" *ngIf="anotote.active && anotote.type==2" [@enterAnimation]>
                    <div class="quotes layout message-underlist">
                        <ion-list no-lines class="details-list layout">
                            <ion-item class="underlist-items" *ngFor="let message of messages">
                                <figure>
                                    <img [src]="message | chatHeads" alt="">
                                    <!--<img [src]="assets/img/check-green.png" alt="">-->
                                </figure>
                                <div class="check-text">
                                    <div class="name-time">
                                        <span class="user" *ngIf="message.senderId == user.id">Me</span>
                                        <span class="user" *ngIf="message.senderId != user.id">{{anotote.chatGroup.groupUsers[1].user.firstName}} {{anotote.chatGroup.groupUsers[1].user.lastName}}</span>
                                        <span class="msg-time">{{message.createdAt | date: 'hh:mm'}}</span>
                                    </div>
                                    <p [ngStyle]="{'color': 'red'}" *ngIf="message.read == 0 && user.id != message.senderId">{{message.text}}</p>
                                    <p *ngIf="message.read != 0 && user.id != message.senderId">{{message.text}}</p>
                                    <p *ngIf="user.id == message.senderId">{{message.text}}</p>
                                    <img src="assets/img/option-msg.png" alt="">
                                </div>
                            </ion-item>
                            <!--<ion-item class="underlist-items">
                                <figure>
                                    <img src="assets/img/check-yellow.png" alt="">
                                </figure>
                                <div class="check-text">
                                    <div class="name-time">
                                        <span class="user">Chantel Bardaro</span>
                                        <span class="msg-time">11:22</span>
                                    </div>
                                    <p>Agreed, but review the other background research I’ve gathered</p>
                                    <img src="assets/img/option-msg.png" alt="">
                                </div>
                            </ion-item>
                            <ion-item class="underlist-items unread-msg">
                                <figure>
                                    <img src="assets/img/check-red.png" alt="">
                                </figure>
                                <div class="check-text">
                                    <div class="name-time">
                                        <span class="user">Chantel Bardaro</span>
                                        <span class="msg-time">11:22</span>
                                    </div>
                                    <p>Agreed, but review the other background research I’ve gathered</p>
                                    <img src="assets/img/option-msg.png" alt="">
                                </div>
                            </ion-item>-->
                        </ion-list>
                    </div>
                </div>
                <!-- anatote detail -->
            </ion-item>
        </ion-list>
        <div class="no_totes" [hidden]="has_totes">
            <p [ngClass]="{'green': current_color == 'me', 'yellow':current_color == 'follow', 'pink':current_color == 'top' }">No totes found.</p>
        </div>
        <ion-infinite-scroll (ionInfinite)="doInfinite($event)" *ngIf="anototes.length > 0 && anototes.length % 10 == 0">
            <ion-infinite-scroll-content loadingSpinner="bubbles" loadingText="Loading more data...">
            </ion-infinite-scroll-content>
        </ion-infinite-scroll>
        <!--<ion-list *ngIf="edit_mode" no-lines class="product-list show">-->
        <!--<ion-item (tap)="bulkAction(anotote)" class="profile-wrap" *ngFor="let anotote of anototes;let index=index; let odd=odd; let even=even;"-->
        <!--[ngClass]="anotote.checked?'even':''">-->
        <!--<div class="check">-->
        <!--<img *ngIf="!anotote.checked" src="assets/img/check1.png">-->
        <!--<img *ngIf="anotote.checked" src="assets/img/check2.png">-->
        <!--</div>-->
        <!--<div class="txt">-->
        <!--<div class="txt-holder">-->
        <!--<strong [innerText]="anotote.title"></strong>-->
        <!--</div>-->
        <!--<div class="time">-->
        <!--<em>-->
        <!--<button type="button">-->
        <!--<ion-icon *ngIf="anotote.type=='message'" name="chatbubbles"></ion-icon>-->
        <!--<ion-icon *ngIf="anotote.type=='anotote_txt'" name="text"></ion-icon>-->
        <!--<ion-icon *ngIf="anotote.type=='anotote_video'" name="videocam"></ion-icon>-->
        <!--<ion-icon *ngIf="anotote.type=='anotote_image'" name="image"></ion-icon>-->
        <!--<ion-icon *ngIf="anotote.type=='anotote_audio'" name="musical-notes"></ion-icon>-->
        <!--</button>-->
        <!--<span [innerText]="anotote.time"></span>-->
        <!--</em>-->
        <!--<p [innerText]="anotote.short_text"></p>-->
        <!--</div>-->
        <!--</div>-->
        <!--</ion-item>-->
        <!--</ion-list>-->
    </div>
    <ion-fab *ngIf="!current_active_anotote" bottom right>
        <button (tap)="presentViewOptionsModal()" ion-fab [color]="current_color">
            <img src="assets/img/tot_icon_white.png" />
        </button>
    </ion-fab>
</ion-content>
<span navPop class="wedge_icon"></span>
<ion-footer class="message-bottom" *ngIf="current_active_anotote && (current_active_anotote.active && current_active_anotote.type == 'message')">
    <ion-toolbar color="dark">
        <p style="text-align: center; color: white;" *ngIf="!reply_box_on" (tap)="show_reply_box()">Reply to Chantel Bardaro</p>
        <div *ngIf="reply_box_on" class="send-btn">
            <img src="assets/img/check-green.png" alt="">
            <input type="text" value="" name="search" placeholder="Reply to Chantel Bardaro">
            <input type="submit" value="Send" name="send">
        </div>
    </ion-toolbar>
</ion-footer>