<ion-header class="searchHeader">
    <ion-toolbar color="homeheader">
        <div [ngClass]="{'black': current_url == '', 'green':(current_url != '' && stream_color == 'me'),'yellow':(current_url != '' && stream_color == 'follows'),'pink':(current_url != '' && stream_color == 'top')}" class="search_header">
            <span [ngClass]="filter_mode?'activeOption':''" (click)="show_filters()" class="options"></span>
            <img src="assets/img/searchIcon.png" alt="" />
            <input search-field id="search_field_id" name="search" class="search_field" [(ngModel)]="search_txt" (ngModelChange)="value_updating_search()" type="text" placeholder="Search or enter address" />
            <span (click)="dismiss()" class="clear_button"></span>
        </div>
    </ion-toolbar>
</ion-header>
<ion-content swipe-vertical padding class="searchPage">
    <!-- content-->
    <ion-list class="searchItems" *ngIf="!filter_mode">
        <ion-item *ngIf="search_loading" class="search_spinner">
            <ion-spinner name="ios"></ion-spinner>
        </ion-item>
        <ion-item (click)="show_share_options()" *ngIf="current_url" class="searchFilter">
            <img src="assets/img/simpleShare.svg" alt="" />
            <span>Share this link (enter)</span>
        </ion-item>
        <ion-item (click)="clear_deep_link()" *ngIf="current_url" class="searchFilter searchIcon">
            <img src="assets/img/searchIcon.svg" alt="" />
            <span>New search or address</span>
        </ion-item>
        <!-- <ion-item *ngIf="!current_url && search_txt.length>0 && !entering_url && search_results.length==0 && !search_loading" class="searchFilter">
            <img src="assets/img/searchBlack.png" alt="">
            <span>No results</span>
        </ion-item> -->
        <ion-item (click)="get_search_results()" *ngIf="!current_url && search_txt.length>0 && !entering_url && !search_loading" class="searchFilter">
            <img src="assets/img/searchIcon.svg" alt="">
            <span>Search (enter)</span>
        </ion-item>
        <ion-item (click)="!current_url && scrape_this_url()" *ngIf="search_txt.length > 0 && entering_url" class="searchFilter">
            <img class="viewIcon" src="assets/img/searchIcon.svg" alt="">
            <span>View (enter)</span>
        </ion-item>
        <ion-item (click)="save_search_entry('save_entry')" *ngIf="!current_url && search_txt.length>0 && entering_url" class="searchFilter">
            <ion-icon name="ios-cloud"></ion-icon>
            <span>Save</span>
        </ion-item>
        <ion-item (click)="save_search_entry('bookmark_entry')" *ngIf="!current_url && search_txt.length>0 && entering_url" class="searchFilter">
            <ion-icon name="ios-bookmark"></ion-icon>
            <span>Bookmark</span>
        </ion-item>
        <div *ngIf="search_txt.length>0" class="searchResult">
            <ion-item *ngFor="let search_result of search_results" (click)="showProfile(search_result)" class="user_list_item">
                <div class="totoField">
                    <figure *ngIf="search_result.is_tote == true">
                        <img *ngIf="search_result.annotote.photo==null || search_result.annotote.photo==''" src="assets/img/img3.jpg">
                        <img (load)="loaded = true" [ngClass]="{'img-loaded': loaded}" *ngIf="search_result.annotote.photo != null && search_result.annotote.photo != ''" [hidden]="!loaded" [src]="search_result.annotote.photo | image_base_path">
                        <ion-spinner *ngIf="!loaded && search_result.annotote.photo != null && search_result.annotote.photo != ''"></ion-spinner>
                    </figure>
                    <figcaption *ngIf="search_result.is_tote == true">
                        <h4 [innerText]="search_result.annotote.title"></h4>
                        <span class="rightContent">
                            {{search_result.annotote.createdAt * 1000 | date:'shortTime'}}
                        </span>
                        <div class="toteText">
                            <p>{{search_result.annotote.source}}</p>
                            <button type="button" class="">
                                <img alt="" src="assets/img/lineIcon.svg">
                            </button>
                        </div>
                        <!-- <span class="rightAdd"><ion-icon name="add"></ion-icon></span> -->
                    </figcaption>
                </div>
                <div class="userField">
                    <figure *ngIf="search_result.is_tote == false">
                        <img *ngIf="search_result.photo== null || search_result.photo==''" src="assets/img/img3.jpg">
                        <img (load)="loaded = true" [ngClass]="{'img-loaded': loaded}" *ngIf="search_result.photo != null && search_result.photo != ''" [hidden]="!loaded" [src]="search_result.photo | image_base_path">
                        <ion-spinner *ngIf="!loaded && search_result.photo != null && search_result.photo != ''"></ion-spinner>
                    </figure>
                    <figcaption class="followUser" *ngIf="search_result.is_tote == false">
                        <h4>{{search_result.firstName}} {{search_result.lastName}} <i *ngIf="search_result.isFollowed == 1"><</i></h4>
                        <!-- <span class="rightContent">
                            {{search_result.annotote.createdAt * 1000 | date:'shortTime'}}<ion-icon class="lines" name="menu"></ion-icon>
                        </span> -->
                        <span class="rightAdd" *ngIf="search_result.isFollowed == 0 && search_result.follow_loading == false" (click)="followUser($event,search_result)"><ion-icon name="add"></ion-icon></span>
                        <span class="rightAdd" *ngIf="search_result.follow_loading == true">
                            <ion-spinner name="bubbles"></ion-spinner>
                        </span>
                        <span class="rightAdd" *ngIf="search_result.isFollowed == 1">@</span>
                    </figcaption>
                </div>
            </ion-item>
        </div>
    </ion-list>
    <ion-list *ngIf="filter_mode" class="filterMode">
        <div class="mediaMode">
            <h4>Media</h4>
            <ul>
                <li *ngIf="search_filters.media.tote == false" (click)="anotote_or_user_filter('tote')"><img src="assets/img/tile-gray.png" alt=""></li>
                <li *ngIf="search_filters.media.tote == true" (click)="anotote_or_user_filter('tote')"><img src="assets/img/tile_dark.png" alt=""></li>
                <!-- <li><img src="assets/img/roundbox.png" alt=""></li>
                <li><img src="assets/img/blackTag.png" alt=""></li>
                <li><img src="assets/img/blackPlay.png" alt=""></li> -->
                <li *ngIf="search_filters.media.user == false" (click)="anotote_or_user_filter('user')"><img src="assets/img/@icon-gray.png" alt=""></li>
                <li *ngIf="search_filters.media.user == true" (click)="anotote_or_user_filter('user')"><img src="assets/img/icon_dark.png" alt=""></li>
                <!-- <li><img src="assets/img/chat-gray.png" alt=""></li> -->
            </ul>
        </div>
        <div class="catMode" *ngIf="search_filters.media.user == false">
            <h4>Category</h4>
            <ul>
                <li [ngClass]="{'active': search_filters.category.me == true}" (click)="category_filter('me')"><span>Me</span></li>
                <li [ngClass]="{'active': search_filters.category.follows == true}" (click)="category_filter('follows')"><span>Follows</span></li>
                <li [ngClass]="{'active': search_filters.category.top == true}" (click)="category_filter('top')"><span>Top</span></li>
            </ul>
        </div>
        <div class="dateMode" *ngIf="search_filters.media.user == false">
            <h4>Date</h4>
            <ul>
                <li><input type="number" [(ngModel)]="search_filters.date.year" name="year" placeholder="YYYY"></li>
                <li><input type="number" [(ngModel)]="search_filters.date.month" name="month" placeholder="MM"></li>
                <li><input type="number" [(ngModel)]="search_filters.date.day" name="day" placeholder="DD"></li>
            </ul>
        </div>
    </ion-list>
</ion-content>