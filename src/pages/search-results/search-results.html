<ion-header class="searchHeader">
    <!-- <ion-toolbar class="resultHead">
        <ion-buttons class="searchBtn" start>
            <button class="search_icon" (click)="show_search()" ion-button icon-only>
                <img src="assets/img/searchIcon.png" alt="">
            </button>
        </ion-buttons>
        <div class="searchFiels" [ngClass]="show_search_field ? 'active':''">
            <form (ngSubmit)="load_search_results()" name="login_form">
                <input type="text" [(ngModel)]="search_term" class="searchTxt" name="search" placeholder="Search">
            </form>
            <img class="icon" src="assets/img/closeIconGray.svg" alt="">
        </div>
        <ion-title *ngIf="hide_header_contents == false">
            <div class="dots_box">
                <span class="un_active_dot"></span>
                <span class="dot"></span>
            </div>
        </ion-title>
    </ion-toolbar> -->
    <ion-toolbar color="homeheader" [ngClass]="{'noShadow': search_txt == ''}">
        <div class="search_header">
            <span [ngClass]="filter_mode?'activeOption':''" class="options"></span>
            <img src="assets/img/searchIcon.png" alt="" />
            <form (ngSubmit)="load_search_results()" name="login_form">
                <input search-field id="search_field_id" name="search" class="search_field" [(ngModel)]="search_term" type="text" placeholder="Search or enter address" />
            </form>
            <span (click)="clear()" class="clear_button"></span>
        </div>
    </ion-toolbar>
</ion-header>
<span navPop class="wedge_icon"></span>
<ion-content swipe-vertical padding>
    <div class="search-panel">
        <div *ngIf="_loading" class="_spinner">
            <ion-spinner name="ios"></ion-spinner>
        </div>
        <div class="no_search" *ngIf="no_search == true">
            <p>No results</p>
        </div>
        <ion-list class="search-result">
            <ion-item *ngFor="let anotote of search_results; let i = index">
                <div [ngClass]="{'activeTote' : current_active_anotote==anotote }" (click)="openAnototeDetail(anotote)" *ngIf="anotote.is_tote == true">
                    <div class="img-holder" (click)="presentAnototeOptionsModal($event,anotote)">
                    </div>
                    <div class="txt txtMiddel" [ngClass]="{'txtToto': edit_mode == true}">
                        <p *ngIf="anotote.userAnnotote.isMe == 0 && anotote.userAnnotote.isTop == 0">{{anotote.selected_follower_name}}
                            <ng-container *ngIf="anotote.userAnnotote.follows.length > 2">+ {{anotote.userAnnotote.follows.length - 1}} others</ng-container>
                            <ng-container *ngIf="anotote.userAnnotote.follows.length == 2">+ {{anotote.userAnnotote.follows.length - 1}} other</ng-container>
                        </p>
                        <strong [ngClass]="{'opened': anotote.active}" [innerText]="anotote.userAnnotote.userAnnotote.annototeTitle"></strong>
                        <div class="time">
                            <em>
                                <span [innerText]="anotote.userAnnotote.userAnnotote.createdAt | time_stamp"></span>
                            </em>
                        </div>
                        <div class="toteText">
                            <p [innerText]="anotote.userAnnotote.annotote.source"></p>
                            <button type="button">
                                <!-- <img src="assets/img/lineIcon.svg" alt=""> -->
                                <ion-icon name="menu"></ion-icon>
                            </button>
                        </div>
                    </div>
                </div>
                <!-- anatote detail  (press)="enable_list_reorder(anotote)"-->
                <div class="toteActive" [ngClass]="{'toteTransition': anotote.active}" *ngIf="anotote.is_tote == true">
                    <header class="listHeader">
                        <div class="underlist-text">
                            <div class="btns-area">
                                <button ion-button *ngIf="anotote.userAnnotote.isMe == 1" class="me-tab active_me" [ngClass]="{'active_me': anotote.userAnnotote.isMe == 1}">Me</button>
                                <button class="me-tab active_follows" ion-button *ngIf="anotote.userAnnotote.isMe == 0 && anotote.userAnnotote.isTop == 0">{{anotote.selected_follower_name}}</button>
                                <button ion-button class="me-tab active_top" *ngIf="anotote.userAnnotote.isTop == 1">Top</button>
                            </div>
                        </div>
                    </header>
                    <div class="quotes layout message-underlist" [hidden]="anotote.spinner_for_active == true">
                        <ion-list no-lines class="details-list layout" *ngIf="anotote.userAnnotote.highlights.length > 0">
                            <ng-container *ngFor="let highlight of anotote.userAnnotote.highlights">
                                <ion-item (click)="go_to_browser(anotote,highlight)" *ngIf="highlight.deleted != 1" class="underlist-items">
                                    <div class="txt">
                                        <p>{{highlight.highlightText}}</p>
                                        <p class="lightText" *ngIf="highlight.comment != null && highlight.comment != '' && (highlight.edit == undefined || highlight.edit == false)">{{highlight.comment}}</p>
                                        <!-- <div class="tagImage" *ngIf="highlight.tags.length > 0 && (highlight.edit == undefined || highlight.edit == false)" (click)="show_tags_for_annotation($event,anotote.active_tab,highlight)">
                                            <img src="assets/img/dotsicon.svg" alt="">
                                        </div> -->
                                    </div>

                                    <span class="status quoteStatus" [ngClass]="{'quotes_follows':  anotote.userAnnotote.isMe == 0 && anotote.userAnnotote.isTop == 0,'quotes_top':  anotote.userAnnotote.isTop == 1}" *ngIf="highlight.comment == null || highlight.comment == ''">
                                        <img src="assets/img/quoteImg.svg" alt="">
                                    </span>
                                    <span class="status" [ngClass]="{'quotes_follows':  anotote.userAnnotote.isMe == 0 && anotote.userAnnotote.isTop == 0,'quotes_top':  anotote.userAnnotote.isTop == 1}" *ngIf="highlight.comment != null && highlight.comment != ''">
                                        <img src="assets/img/commentImg.svg" alt="">
                                    </span>
                                </ion-item>
                            </ng-container>
                        </ion-list>
                    </div>
                </div>
                <!-- User -->
                <li *ngIf="anotote.is_tote == false" (click)="showProfile(anotote)">
                    <figure>
                        <img *ngIf="anotote.photo== null || anotote.photo==''" src="assets/img/userGray.svg">
                        <img (load)="loaded = true" [ngClass]="{'img-loaded': loaded}" *ngIf="anotote.photo != null && anotote.photo != ''" [hidden]="!loaded" [src]="anotote.photo | image_base_path">
                        <ion-spinner *ngIf="!loaded && anotote.photo != null && anotote.photo != ''"></ion-spinner>
                    </figure>
                    <figcaption>
                        <!-- <h4>Search result {{i+1}}</h4>
                        <span>{{anotote.firstName}}
                            <i *ngIf="anotote.isFollowed == 1">
                                <</i>
                                    <b>
                                        <ion-icon *ngIf="anotote.isFollowed == 0" (click)="followUser($event,search_result)" name="add"></ion-icon>
                                        <i *ngIf="anotote.isFollowed == 1">@</i>
                                    </b>
                        </span>
                        <span class="excerptTxt">{{anotote.description}}</span> -->
                        <h4>{{anotote.firstName}}
                            <img *ngIf="anotote.isFollowed == 1" class="star-icon" src="assets/img/star-gray.png" alt="">
                        </h4>
                        <span class="rightAdd" *ngIf="anotote.isFollowed == 0 && anotote.follow_loading == false" (click)="followUser($event,anotote)">FOLLOW</span>
                        <span class="rightAdd" *ngIf="anotote.follow_loading == true">
                            <ion-spinner name="bubbles"></ion-spinner>
                        </span>
                    </figcaption>
                </li>
            </ion-item>
        </ion-list>
    </div>
    <ion-fab bottom [ngClass]="{'moveUpList': move_fab == true || forFollowedCaseName == true}" right>
        <button (tap)="presentViewOptionsModal()" ion-fab [color]="current_active_anotote == null ? 'anon' : current_active_anotote.userAnnotote.active_tab">
            <img *ngIf="current_active_anotote == null || current_color == 'anon'" src="assets/img/whiteFab.svg" />
            <ng-container *ngIf="current_active_anotote != null">
                <img *ngIf="current_active_anotote != null &&  current_active_anotote.userAnnotote.active_tab == 'me' && current_active_anotote.userAnnotote.follows.length > 0 && current_active_anotote.userAnnotote.isTop == 1" src="assets/img/greenFab1.svg" />
                <img *ngIf="current_active_anotote != null &&  current_active_anotote.userAnnotote.active_tab == 'me' && current_active_anotote.userAnnotote.follows.length > 0 && current_active_anotote.userAnnotote.isTop == 0" src="assets/img/greenFab2.svg" />
                <img *ngIf="current_active_anotote != null &&  current_active_anotote.userAnnotote.active_tab == 'me' && current_active_anotote.userAnnotote.follows.length == 0 && current_active_anotote.userAnnotote.isTop == 1" src="assets/img/greenFab3.svg" />
                <img *ngIf="current_active_anotote != null &&  current_active_anotote.userAnnotote.active_tab == 'me' && current_active_anotote.userAnnotote.follows.length == 0 && current_active_anotote.userAnnotote.isTop == 0" src="assets/img/greenFab4.svg" />
                <!-- Active tab follows -->
                <img *ngIf="current_active_anotote != null && current_active_anotote.userAnnotote.active_tab == 'follows' && current_active_anotote.userAnnotote.isMe == 1 && current_active_anotote.userAnnotote.isTop == 1" src="assets/img/yellowFab1.svg" />
                <img *ngIf="current_active_anotote != null && current_active_anotote.userAnnotote.active_tab == 'follows' && current_active_anotote.userAnnotote.isMe == 1 && current_active_anotote.userAnnotote.isTop == 0" src="assets/img/yellowFab2.svg" />
                <img *ngIf="current_active_anotote != null && current_active_anotote.userAnnotote.active_tab == 'follows' && current_active_anotote.userAnnotote.isMe == 0 && current_active_anotote.userAnnotote.isTop == 1" src="assets/img/yellowFab3.svg" />
                <img *ngIf="current_active_anotote != null && current_active_anotote.userAnnotote.active_tab == 'follows' && current_active_anotote.userAnnotote.isMe == 0 && current_active_anotote.userAnnotote.isTop == 0" src="assets/img/yellowFab4.svg" />
                <!-- Active tab top -->
                <img *ngIf="current_active_anotote != null && current_active_anotote.userAnnotote.active_tab == 'top' && current_active_anotote.userAnnotote.isMe == 1 && current_active_anotote.userAnnotote.follows.length > 0" src="assets/img/pinkFab1.svg" />
                <img *ngIf="current_active_anotote != null && current_active_anotote.userAnnotote.active_tab == 'top' && current_active_anotote.userAnnotote.isMe == 0 && current_active_anotote.userAnnotote.follows.length > 0" src="assets/img/pinkFab2.svg" />
                <img *ngIf="current_active_anotote != null && current_active_anotote.userAnnotote.active_tab == 'top' && current_active_anotote.userAnnotote.isMe == 1 && current_active_anotote.userAnnotote.follows.length == 0" src="assets/img/pinkFab3.svg" />
                <img *ngIf="current_active_anotote != null && current_active_anotote.userAnnotote.active_tab == 'top' && current_active_anotote.userAnnotote.isMe == 0 && current_active_anotote.userAnnotote.follows.length == 0" src="assets/img/pinkFab4.svg" />
            </ng-container>
        </button>
        <button *ngIf="unread_notification_count > 0" ion-button icon-only class="notices">{{unread_notification_count}}</button>
    </ion-fab>
</ion-content>